<!DOCTYPE html>
<html>

<head>
  <script src="https://unpkg.com/konva@9.3.13/konva.min.js"></script>
  <meta charset="utf-8" />
  <title>Konva Groups Demo</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #f0f0f0;
    }
  </style>
</head>

<body>
  <div id="container"></div>
  <script>

    const data = [{
      version:'Primary(English)',
      class:'XI',
      roll:'23',
      year:'2024',
      mobile:'1234567890',
      pic: "https://firebasestorage.googleapis.com/v0/b/agamilabs-edubd.appspot.com/o/files%2Fstudent%2FEsGaQ_1719903359259.jpg?alt=media&token=8fe4166a-84ac-47ec-a777-de31121d130c",
      name: "maruf bin solaiman siddique",
      id: "4567887654"
    },
    // {
    //   pic: "https://firebasestorage.googleapis.com/v0/b/agamilabs-edubd.appspot.com/o/files%2Fstudent%2FEsGaQ_1719903359259.jpg?alt=media&token=8fe4166a-84ac-47ec-a777-de31121d130c",
    //   name: "udayan",
    //   id: "8765"
    // },
    // {
    //   pic: "https://firebasestorage.googleapis.com/v0/b/agamilabs-edubd.appspot.com/o/files%2Fstudent%2FEsGaQ_1719903359259.jpg?alt=media&token=8fe4166a-84ac-47ec-a777-de31121d130c",
    //   name: "apon",
    //   id: "456789"
    // },
    // {
    //   pic: "https://firebasestorage.googleapis.com/v0/b/agamilabs-edubd.appspot.com/o/files%2Fstudent%2FEsGaQ_1719903359259.jpg?alt=media&token=8fe4166a-84ac-47ec-a777-de31121d130c",
    //   name: "apon",
    //   id: "456789"
    // },
    // {
    //   pic: "https://firebasestorage.googleapis.com/v0/b/agamilabs-edubd.appspot.com/o/files%2Fstudent%2FEsGaQ_1719903359259.jpg?alt=media&token=8fe4166a-84ac-47ec-a777-de31121d130c",
    //   name: "apon",
    //   id: "456789"
    // },
  ]
    var width = window.innerWidth;
    var height = window.innerHeight;
    var pageHeight = 793.92;
    var pageWidth = 1122.24;

    var stage = new Konva.Stage({
      container: 'container',
      width: 204,
      height: 324,
    });

    var layer = new Konva.Layer();
    var layer1 = new Konva.Layer();
    var backgroundLayer = new Konva.Layer();
    var imageLayer = new Konva.Layer();
    var nameLayer = new Konva.Layer();
    var additionalLayer = new Konva.Layer();
    var barcodeLayer = new Konva.Layer();

    
  

    data.map(async (d,i) => {
      await Konva.Image.fromURL('../Assets/images/imagecard.png',async function(backgroundNode){
        backgroundNode.setAttrs({
          x: 0,
          y: 0,
          height:324,
          width:204,
        })
        backgroundLayer.add(backgroundNode);
      })


      await Konva.Image.fromURL(d.pic, async function (avatar) {
        avatar.setAttrs({
          y: 67,
          x: (stage.width() - 100) / 2,
          height:100,
          width:100,
          stroke:'#3B75C4',
          strokeWidth:'3',
          cornerRadius: 60
        });
        imageLayer.add(avatar);
      });


      var nameText = await new Konva.Text({
        x: stage.width() /2,
        y: 175,
        text: `${d.name.toLocaleUpperCase()}`,
        fontSize: 16,
        fontStyle:700,
        width:stage.width()-20,
        fontFamily: 'Calibri',
        fill: 'black',
        align: 'center'
      })
      nameText.offsetX(nameText.width() / 2);
      nameLayer.add(nameText)

      var additionalText = await new Konva.Text({
        x: stage.width() /2,
        y: 210,
        text: `ID NO          : ${d.id}\nVERSION     : ${d.version.toLocaleUpperCase()}\nCLASS          : ${d.class}\nROLL            : ${d.roll}\nYEAR            : ${d.year}\nMOBILE       : ${d.mobile}`,
        fontSize: 12,
        // fontStyle:700,
        width:stage.width()-40,
        fontFamily: 'Calibri',
        fill: 'black',
        align: 'left'
      })
      additionalText.offsetX(additionalText.width() / 2);
      additionalLayer.add(additionalText)

  
      var imageObj = new Image();
      imageObj.onload = function () {
        var barcode = new Konva.Image({
          x: 22,
          y: 293,
          image: imageObj,
          width:130,
          height: 20,
          stroke:'white',
          strokeWidth:4,
          cornerRadius: 2,
        });

        // add the shape to the layer
        barcodeLayer.add(barcode);
      };
      imageObj.src = `https://barcodeapi.org/api/BAF${d.id}?text=none`;





    }
    )

 
    stage.add(backgroundLayer)
    stage.add(imageLayer)
    stage.add(nameLayer)
    stage.add(additionalLayer)
    stage.add(barcodeLayer)


  </script>
</body>

</html>